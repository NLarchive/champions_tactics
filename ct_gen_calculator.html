<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gene Inheritance Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1e2a38;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        h1, h3 {
            text-align: center;
            color: #fff;
            margin: 0.5rem;
        }

        h1 {
            font-size: 2rem;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
        }

        .category {
            margin-bottom: 20px;
            width: 100%;
            max-width: 300px;
        }

        select {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 10px;
            font-size: 1rem;
            background-color: #2b4a66;
            color: #fff;
            border: none;
            border-radius: 5px;
            outline: none;
        }

        button {
            padding: 1rem 2rem;
            margin: 20px 0;
            font-size: 1.2rem;
            background-color: #2b4a66;
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #3a5365;
        }

        table {
            width: 100%;
            max-width: 800px;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: #2a3c4e;
            color: #fff;
        }

        table, th, td {
            border: 1px solid #555;
        }

        th, td {
            padding: 10px;
            text-align: center;
            font-size: 1rem;
        }

        th {
            background-color: #2b4a66;
        }

        td {
            background-color: #3a5365;
        }

        .title {
            text-align: center;
            font-weight: bold;
            color: #ddd;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .odds-info {
            text-align: center;
            margin-bottom: 10px;
            color: #aaa;
        }

        .child-section {
            margin-top: 20px;
        }

        .child-section h2 {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 20px;
        }

        /* Responsive for smaller screens */
        @media screen and (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            select, button {
                font-size: 1rem;
            }

            .container {
                flex-direction: column;
                align-items: center;
                padding: 1rem;
            }

            table, th, td {
                font-size: 0.9rem;
                padding: 8px;
            }

            .category {
                max-width: 100%;
                width: 90%;
            }
        }

        /* Extra small screens */
        @media screen and (max-width: 480px) {
            h1 {
                font-size: 1.3rem;
            }

            h3 {
                font-size: 1.1rem;
            }

            select, button {
                font-size: 0.9rem;
            }

            th, td {
                font-size: 0.8rem;
            }

            button {
                padding: 0.8rem 1.6rem;
                font-size: 1rem;
            }

            table {
                max-width: 90%;
            }
        }
    </style>
</head>
<body>

    <h1>Gene Inheritance Calculator</h1>
    <h2>odds used are probably but not yet announced</h2>

    <div class="container">
        <div>
            <h3>Parent 1</h3>
            <div class="category">
                <div class="title">Faction</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent1_faction_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent1_faction_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent1_faction_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Job</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent1_job_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent1_job_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent1_job_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Element</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent1_element_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent1_element_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent1_element_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Weapon</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent1_weapon_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent1_weapon_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent1_weapon_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Quirk</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent1_quirk_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent1_quirk_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent1_quirk_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>
        </div>

        <div>
            <h3>Parent 2</h3>
            <div class="category">
                <div class="title">Faction</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent2_faction_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent2_faction_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent2_faction_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Job</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent2_job_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent2_job_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent2_job_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Element</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent2_element_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent2_element_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent2_element_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Weapon</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent2_weapon_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent2_weapon_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent2_weapon_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>

            <div class="category">
                <div class="title">Quirk</div>
                <div class="odds-info">Dominant (0.3 odds)</div>
                <select id="parent2_quirk_dominant">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Recessive (0.15 odds)</div>
                <select id="parent2_quirk_recessive">
                    <option value="">-- No Gene --</option>
                </select>
                <div class="odds-info">Minor Recessive (0.05 odds)</div>
                <select id="parent2_quirk_minor">
                    <option value="">-- No Gene --</option>
                </select>
            </div>
        </div>
    </div>

    <button onclick="calculateInheritance()">Calculate Inheritance</button>

    <table id="results">
        <thead>
            <tr>
                <th>Category</th>
                <th>Dominant</th>
                <th>Recessive</th>
                <th>Minor Recessive</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <div class="child-section">
        <h2>Generate Random Child</h2>
        <button onclick="generateRandomChild()">Generate Random Child</button>
        <table id="childResults">
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Inherited Gene</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        const inheritanceOdds = {
            "Dominant": 0.3,
            "Recessive": 0.15,
            "Minor Recessive": 0.05
        };

        const geneCategories = {
            "FACTION": ['Corporation', 'Cult', 'Empire', 'Guardian', 'Kingdom', 'Tribe', 'Undying'],
            "JOB": ['Arcanist', 'Assassin', 'Barbarian', 'Druid', 'Duelist', 'Huntsman', 'Inquisitor', 'Lord', 'Mystic', 'Necromancer', 'Paladin', 'Protector', 'Scientist', 'Shaman', 'Soldier', 'Sorcerer', 'Warden'],
            "ELEMENT": ['Air', 'Chaos', 'Darkness', 'Fire', 'Light', 'Nature', 'Order', 'Techno', 'Water'],
            "WEAPON": ['Blunderbuss', 'Crossbow', 'Dagger', 'Greataxe', 'Greatsword', 'Halberd', 'Katana', 'Mystical horn', 'Rapier', 'Runic scimitar', 'Scepter', 'Sickle', 'Spatha', 'Spear', 'Spellbook', 'Voodoo doll'],
            "QUIRK": ['Agile', 'Blind', 'Corporate', 'Cult pupil', 'Cursed', 'Demon slayer', 'Desert fighter', 'Evil', 'Lucky', 'Masked', 'One eyed', 'Quick', 'Runic', 'Sacred', 'Strong', 'Veteran', 'Vigilante', 'Zealous']
        };

        function calculateInheritance() {
            const resultsTable = document.getElementById("results").getElementsByTagName("tbody")[0];
            resultsTable.innerHTML = '';  // Clear previous results

            const parent1Genes = getSelectedGenes("parent1");
            const parent2Genes = getSelectedGenes("parent2");

            for (const category in geneCategories) {
                const row = document.createElement("tr");

                // Get genes for each type (Dominant, Recessive, Minor Recessive) from both parents
                const dominantGenes = getCombinedGenes(parent1Genes[category].Dominant, parent2Genes[category].Dominant, inheritanceOdds["Dominant"]);
                const recessiveGenes = getCombinedGenes(parent1Genes[category].Recessive, parent2Genes[category].Recessive, inheritanceOdds["Recessive"]);
                const minorRecessiveGenes = getCombinedGenes(parent1Genes[category]["Minor Recessive"], parent2Genes[category]["Minor Recessive"], inheritanceOdds["Minor Recessive"]);

                // Prepare row content
                row.innerHTML = `
                    <td>${category}</td>
                    <td>${dominantGenes}</td>
                    <td>${recessiveGenes}</td>
                    <td>${minorRecessiveGenes}</td>
                `;
                resultsTable.appendChild(row);
            }
        }

        // Helper function to get combined genes and sum odds for a category
        function getCombinedGenes(gene1, gene2, odds) {
            let result = '';

            if (gene1 && gene2 && gene1 === gene2) {
                // If both parents share the same gene, sum the odds and display it once
                result = `${gene1} (${(odds * 2).toFixed(2)})`;
            } else {
                // Display both genes if they are different
                if (gene1) result += `${gene1} (${odds.toFixed(2)})<br>`;
                if (gene2) result += `${gene2} (${odds.toFixed(2)})`;
            }

            return result;
        }

        // Get selected genes for both parents
        function getSelectedGenes(parent) {
            return {
                "FACTION": {
                    "Dominant": document.getElementById(`${parent}_faction_dominant`).value,
                    "Recessive": document.getElementById(`${parent}_faction_recessive`).value,
                    "Minor Recessive": document.getElementById(`${parent}_faction_minor`).value
                },
                "JOB": {
                    "Dominant": document.getElementById(`${parent}_job_dominant`).value,
                    "Recessive": document.getElementById(`${parent}_job_recessive`).value,
                    "Minor Recessive": document.getElementById(`${parent}_job_minor`).value
                },
                "ELEMENT": {
                    "Dominant": document.getElementById(`${parent}_element_dominant`).value,
                    "Recessive": document.getElementById(`${parent}_element_recessive`).value,
                    "Minor Recessive": document.getElementById(`${parent}_element_minor`).value
                },
                "WEAPON": {
                    "Dominant": document.getElementById(`${parent}_weapon_dominant`).value,
                    "Recessive": document.getElementById(`${parent}_weapon_recessive`).value,
                    "Minor Recessive": document.getElementById(`${parent}_weapon_minor`).value
                },
                "QUIRK": {
                    "Dominant": document.getElementById(`${parent}_quirk_dominant`).value,
                    "Recessive": document.getElementById(`${parent}_quirk_recessive`).value,
                    "Minor Recessive": document.getElementById(`${parent}_quirk_minor`).value
                }
            };
        }

        // Corrected random child generation based on both parents' combined odds
        function generateRandomChild() {
            const childTable = document.getElementById("childResults").getElementsByTagName("tbody")[0];
            childTable.innerHTML = '';  // Clear previous results

            const parent1Genes = getSelectedGenes("parent1");
            const parent2Genes = getSelectedGenes("parent2");

            for (const category in geneCategories) {
                const row = document.createElement("tr");

                // Get the combined odds for Dominant, Recessive, and Minor Recessive genes
                const combinedGenesWithOdds = calculateCombinedOdds(parent1Genes[category], parent2Genes[category], category);

                // If there are no genes selected in both parents, continue to the next category
                if (combinedGenesWithOdds.length === 0) {
                    row.innerHTML = `
                        <td>${category}</td>
                        <td>No Gene Selected</td>
                    `;
                    childTable.appendChild(row);
                    continue;
                }

                // Calculate the total combined odds to be used for random selection
                const totalOdds = combinedGenesWithOdds.reduce((sum, geneObj) => sum + geneObj.odds, 0);

                // Determine which gene is inherited by the child based on combined odds
                const selectedGene = determineChildGene(combinedGenesWithOdds, totalOdds);

                // Display the child gene for each category
                row.innerHTML = `
                    <td>${category}</td>
                    <td>${selectedGene}</td>
                `;
                childTable.appendChild(row);
            }
        }

        // Helper function to calculate combined odds for both parents' genes
        function calculateCombinedOdds(parent1Genes, parent2Genes, category) {
            const combinedOdds = [];
            const categoryGenes = geneCategories[category];
            const dominanceLevels = ["Dominant", "Recessive", "Minor Recessive"];

            categoryGenes.forEach(gene => {
                let odds = 0;
                dominanceLevels.forEach(level => {
                    if (gene === parent1Genes[level]) odds += inheritanceOdds[level];
                    if (gene === parent2Genes[level]) odds += inheritanceOdds[level];
                });

                if (odds > 0) {
                    combinedOdds.push({ gene, odds });
                }
            });

            return combinedOdds;
        }

        // Determine which gene the child inherits based on combined odds
        function determineChildGene(combinedGenesWithOdds, totalOdds) {
            const randomValue = Math.random() * totalOdds;
            let cumulativeOdds = 0;

            for (const geneObj of combinedGenesWithOdds) {
                cumulativeOdds += geneObj.odds;
                if (randomValue <= cumulativeOdds) {
                    return geneObj.gene;
                }
            }

            return combinedGenesWithOdds[combinedGenesWithOdds.length - 1].gene;  // Fallback, should not happen
        }

        // Populate dropdowns with gene options on page load
        window.onload = populateDropdowns;

        function populateDropdowns() {
            const categories = Object.keys(geneCategories);
            categories.forEach(category => {
                const genes = geneCategories[category];
                const parent1DominantSelect = document.getElementById(`parent1_${category.toLowerCase()}_dominant`);
                const parent1RecessiveSelect = document.getElementById(`parent1_${category.toLowerCase()}_recessive`);
                const parent1MinorSelect = document.getElementById(`parent1_${category.toLowerCase()}_minor`);

                const parent2DominantSelect = document.getElementById(`parent2_${category.toLowerCase()}_dominant`);
                const parent2RecessiveSelect = document.getElementById(`parent2_${category.toLowerCase()}_recessive`);
                const parent2MinorSelect = document.getElementById(`parent2_${category.toLowerCase()}_minor`);

                genes.forEach(gene => {
                    const option1 = document.createElement('option');
                    option1.value = gene;
                    option1.text = gene;

                    const option2 = option1.cloneNode(true);
                    const option3 = option1.cloneNode(true);
                    const option4 = option1.cloneNode(true);
                    const option5 = option1.cloneNode(true);
                    const option6 = option1.cloneNode(true);

                    parent1DominantSelect.add(option1);
                    parent1RecessiveSelect.add(option2);
                    parent1MinorSelect.add(option3);

                    parent2DominantSelect.add(option4);
                    parent2RecessiveSelect.add(option5);
                    parent2MinorSelect.add(option6);
                });
            });
        }
    </script>

</body>
</html>
